##Install the software
conda activate ngs2pro 
conda install -c bioconda fastqc 
conda install -c bioconda multiqc

##Run the FASTQC for each read
sudo apt install fastqc                       #Explore the help of FASTQC >>> fastqc -h > fastqc_rep
mkdir -p ~/ngs2/FASTQC_report && cd ~/ngs2/FASTQC_report
for f in ~/ngs2/fqData/extracted/*.fq;do fastqc -noextract $f;done
for f in ~/ngs2/fqData/extracted/*.fq;do gunzip -k $f;done

##Merge the output reports 
mv ../fqData/extracted/*html ./
mv ../fqData/extracted/*zip ./
multiqc -z -o . .

######################################

##Install the software
conda activate ngs2pro
conda install -c bioconda trimmomatic

##Run Trimmomatic
mkdir -p ~/ngs2/trimming && cd ~/ngs2/trimming
f1="$HOME/ngs2/fqData/*.fq.gz"
f2="$HOME/ngs2/fqData/*.fq.gz"
newf1="$HOME/ngs2/fqData/extracted/*.trim.fq.gz"
newf2="$HOME/ngs2/fqData/extracted/*.trim.fq.gz"
newf1U="$HOME/ngs2/fqData/extracted/*.se.trim.fq.gz"
newf2U="$HOME/workdir/fqData/extracted/*.se.trim.fq.gz"

adap="$CONDA_PREFIX/share/trimmomatic-0.39-1/adapters"
trimmomatic PE -threads 1 -phred33 -trimlog trimLogFile -summary statsSummaryFile  $f1 $f2 $newf1 $newf1U $newf2 $newf2U \
ILLUMINACLIP:$adap/TruSeq3-PE.fa:2:30:10:1 SLIDINGWINDOW:4:15 MINLEN:36
